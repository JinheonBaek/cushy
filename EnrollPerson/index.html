<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Enroll Person Face by Using Cognitive API</title>
	<style>
		video, canvas {
			/* Overlap video and canvas at same place */
			position: absolute;
		}
	</style>
</head>
<body>
	<script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
	<script src="https://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>

	<!-- Import webcam javascript -->
	<script type="text/javascript" src="webcam.min.js"></script>
	<!-- Import webcamSnapshot javascript -->
	<script type="text/javascript" src="webcamSnapshot.js"></script>
	<!-- Import track javascript -->
	<script src="build/tracking-min.js"></script>
	<!-- Import Object tracker javascript -->
	<script src="build/data/face-min.js"></script>
	<!-- Import cognitive Face API service library for enroll face in JavaScript -->
	<script type="text/javascript" src="cogEnrollFace.js"></script>

	<script language="JavaScript">
		//Track & Recognize face
		window.onload = function() {
			var isDetected = false;
			var video = document.getElementById('video');
			var canvas = document.getElementById('canvas');
			var context = canvas.getContext('2d');

			var tracker = new tracking.ObjectTracker('face');
			tracker.setInitialScale(4);
			tracker.setStepSize(2);
			tracker.setEdgesDensity(0.1);

			tracking.track('#video', tracker, { camera: true });

			tracker.on('track', function(event) {
				context.clearRect(0, 0, canvas.width, canvas.height);

				if (event.data.length === 0)
				{
				// No face were detected in this frame.
				} else {

					event.data.forEach(function(rect) {
					context.strokeStyle = '#a64ceb';
					context.strokeRect(rect.x, rect.y, rect.width, rect.height);
					context.font = '11px Helvetica';
					context.fillStyle = "#fff";
					context.fillText('x: ' + rect.x + 'px', rect.x + rect.width + 5, rect.y + 11);
					context.fillText('y: ' + rect.y + 'px', rect.x + rect.width + 5, rect.y + 22);
					});
				}
			});
		};
	</script>

	<!-- Hidden form and button to upload image on server -->
	<div id="snapshotButton">
		<form id="myform" method="post" action="upload.php">
			Username: <input type="text" name="usrname" id="usrname"><br>
			<input id="mydata" type="hidden" name="mydata" value="">
			<input type=button value="Take Snapshot" onClick="snapshot()">
		</form>
	</div>

	<div class="result">
		<p id="resultInfo"> </p>
	</div>

	<div class="frame">
		<!-- Show webcam video -->
		<video id="video" width="640" height="480" preload autoplay loop muted></video>
		<!-- Make canvas for traking face -->
		<canvas id="canvas" width="640" height="480"></canvas>
	</div>

	<script language="JavaScript">
		function snapshot() {
			video.pause();
			takeSnapshot();
		}
	</script>

	<!-- Configure a few setting & Attach camera -->
	<script language="JavaScript">
		Webcam.set({
			width: 640,
			height: 480,
			image_format: 'jpeg',
			jpeg_quality: 90,
		});
		Webcam.attach( '#video' );
	</script>

</body>
</html>